// AI-Generated Code Example with Human Validation

/**
 * AI-generated function for user authentication with human review
 *
 * Generated by: Claude AI
 * Reviewed by: @senior-dev
 * Security validated: @security-team
 * Performance tested: Load testing passed
 */
async function authenticateUser(credentials) {
  // AI generated comprehensive input validation
  const { email, password } = validateCredentials(credentials);

  // AI implemented secure user lookup with proper error handling
  const user = await userRepository.findByEmail(email);
  if (!user) {
    // Timing attack prevention - same processing time for invalid users
    await bcrypt.hash("dummy-password", 12);
    throw new AuthenticationError("Invalid credentials");
  }

  // AI generated secure password comparison
  const isValidPassword = await bcrypt.compare(password, user.hashedPassword);
  if (!isValidPassword) {
    throw new AuthenticationError("Invalid credentials");
  }

  // Human-validated session creation
  return sessionService.createSession(user);
}